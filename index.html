<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>index.html</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

<div class="app-shell">

    <!-- TOP NAV BAR -->
    <header class="top-nav">
        <div class="top-nav-left">
            <span class="top-nav-home">Home</span>
        </div>
        <div class="top-nav-center">
            <span>E9x M3 U.S</span>
            <span class="divider">|</span>
            <span>U.S Database - 00001</span>
        </div>
        <div class="top-nav-right">
            <span>Public User</span>
            <span class="user-icon">ðŸ‘¤</span>
        </div>
    </header>

    <!-- TITLE ROW -->
    <div class="owner-row">
        <div class="owner-pill"></div>
        <div class="owner-labels">
            <span class="owner-main">Owner images</span>
            <span class="owner-sub">E9x M3 Inventory</span>
        </div>
    </div>

    <!-- SUMMARY -->
    <div class="summary-row">
        <div class="summary-left">
            <input type="checkbox" class="summary-checkbox">
            <span class="summary-text">
                <span id="count">0</span> of 25,672 Vehicle(s)
            </span>
            <span class="badge-m3">M3</span>
        </div>
    </div>

    <!-- TABLE -->
    <div class="grid-wrapper">
        <div class="grid-inner">

            <!-- HEADERS -->
            <div class="column-labels">
                <div class="header-cell header-status">Cat.</div>
                <div class="header-cell header-checkbox"></div>
                <div class="header-cell header-marketing">Model Name</div>
                <div class="header-cell header-model">Model</div>
                <div class="header-cell header-color">Ext.</div>
                <div class="header-cell header-interior">Int.</div>
                <div class="header-cell header-year">Yr.</div>
                <div class="header-cell header-vin">VIN</div>
                <div class="header-cell header-packages">Packages</div>
                <div class="header-cell header-price">MSRP</div>
                <div class="header-cell header-dealer">Dealer</div>
            </div>

            <!-- FILTER ROW -->
            <div class="table-header">
                <div class="header-cell header-status"></div>
                <div class="header-cell header-checkbox"></div>
                <div class="header-cell header-marketing"><input class="filter-input" data-field="marketing"></div>
                <div class="header-cell header-model"><input class="filter-input" data-field="model"></div>
                <div class="header-cell header-color"><input class="filter-input" data-field="color"></div>
                <div class="header-cell header-interior"><input class="filter-input" data-field="interior"></div>
                <div class="header-cell header-year"><input class="filter-input" data-field="year"></div>
                <div class="header-cell header-vin"><input class="filter-input" data-field="vin"></div>
                <div class="header-cell header-packages"><input class="filter-input" data-field="packages"></div>
                <div class="header-cell header-price"><input class="filter-input" data-field="price"></div>
                <div class="header-cell header-dealer"><input class="filter-input" data-field="dealer"></div>
            </div>

            <!-- DYNAMIC ROWS -->
            <div id="table-rows"></div>

        </div>
    </div>
</div>

<!-- CSV SCRIPT -->
<script>
async function loadCSV() {
    const response = await fetch("data.csv");
    const csvText = await response.text();

    const rows = csvText.trim().split("\n")
        .map(r => r.match(/(".*?"|[^",]+)(?=\s*,|\s*$)/g));

    const headers = rows.shift(); 
    const table = document.getElementById("table-rows");

    rows.forEach((values, index) => {
        const obj = {};
        headers.forEach((h, i) => obj[h] = (values[i] || "").replace(/^"|"$/g, ""));

        const html = `
        <div class="table-row">
            <div class="cell cell-status"><div class="status-circle">G</div></div>
            <div class="cell cell-checkbox"><input type="checkbox"></div>

            <div class="cell cell-marketing">
                <div class="tooltip">
                    <div class="marketing-name" style="background-image:url('${obj.exterior_image}')">
                        <span>${obj.marketing_name}</span>
                    </div>
                    <div class="tooltiptext tooltip-red-content">${obj.marketing_name}</div>
                </div>
            </div>

            <div class="cell cell-model">${obj.model}</div>

            <div class="cell cell-color">
                <div class="color-cell">
                    <span class="circle" style="background-color: rgb(${obj.ext_rgb});"></span>
                    <div class="label">${obj.ext_code}</div>
                </div>
            </div>

            <div class="cell cell-interior">
                <div class="color-cell">
                    <span class="square" style="background-image:url('${obj.interior_image}')"></span>
                    <div class="label">${obj.interior_code}</div>
                </div>
            </div>

            <div class="cell cell-year">${obj.year}</div>

            <div class="cell cell-vin">
                <span class="vin-text" id="vin-${index}">${obj.vin}</span>
                <button class="copy-btn" data-copy-target="vin-${index}">â§‰</button>
            </div>

            <div class="cell cell-packages">${obj.packages}</div>
            <div class="cell cell-price"></div>
            <div class="cell cell-dealer"></div>
        </div>
        `;

        table.insertAdjacentHTML("beforeend", html);
    });

    document.getElementById("count").innerText = rows.length;
    initCopyButtons();
}

function initCopyButtons() {
    document.querySelectorAll(".copy-btn").forEach(btn => {
        btn.onclick = () => {
            const id = btn.dataset.copyTarget;
            const el = document.getElementById(id);
            navigator.clipboard.writeText(el.textContent.trim());
            btn.classList.add("copied");
            setTimeout(() => btn.classList.remove("copied"), 600);
        };
    });
}

loadCSV();
</script>

</body>
</html>
